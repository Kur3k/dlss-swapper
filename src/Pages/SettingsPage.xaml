<Page
    x:Class="DLSS_Swapper.Pages.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ct_converters="using:CommunityToolkit.WinUI.Converters"
    xmlns:converters="using:DLSS_Swapper.Converters"
    xmlns:usercontrols="using:DLSS_Swapper.UserControls"
    xmlns:system="using:System"
    xmlns:local="using:DLSS_Swapper"
    xmlns:ct_winui="using:CommunityToolkit.WinUI"
    mc:Ignorable="d"
    NavigationCacheMode="Required">
    <Page.Resources>
        <ct_converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" TrueValue="Visible" FalseValue="Collapsed" />
        <ct_converters:BoolToVisibilityConverter x:Key="BoolToNegationVisibilityConverter"  TrueValue="Collapsed" FalseValue="Visible" />
        <ct_converters:BoolNegationConverter x:Key="BoolNegationConverter" />
    </Page.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" Padding="16,0,16,0">
            <TextBlock Margin="16,0,0,0" Text="{x:Bind ViewModel.SettingsText}" TextWrapping="NoWrap" Style="{StaticResource TitleTextBlockStyle}" VerticalAlignment="Center" />

            <!-- Needed to achieve parity in the looking with other sites -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <AppBarButton Label="" IsEnabled="False"/>
            </StackPanel>
        </Grid>

        <InfoBar x:Name="AdminInfoBar"
                 Grid.Row="1"
                 IsOpen="True"
                 Severity="Warning"
                 IsClosable="False"
                 Title="{x:Bind ViewModel.WarningText}"
                 Message="{x:Bind ViewModel.ApplicationRunsInAdministrativeModeInfo}"
                 Visibility="{x:Bind system:Environment.IsPrivilegedProcess, Converter={StaticResource BoolToVisibilityConverter}}" />

        <ScrollViewer Grid.Row="2">
            <StackPanel HorizontalAlignment="Left" Padding="56,0,56,56">
                <TextBlock
                    Style="{StaticResource SubtitleTextBlockStyle}"
                    Margin="0,40,0,0"
                    Text="{x:Bind ViewModel.ThemeModeText}" />
                <StackPanel x:Name="ThemePanel" Margin="0,10,0,0">
                    <RadioButton x:Name="LightThemeRadioButton" GroupName="ThemeGroup" Tag="Light" IsChecked="{x:Bind ViewModel.LightThemeSelected, Mode=TwoWay}" Content="{x:Bind ViewModel.ThemeLightText}" />
                    <RadioButton x:Name="DarkThemeRadioButton" GroupName="ThemeGroup" Tag="Dark" IsChecked="{x:Bind ViewModel.DarkThemeSelected, Mode=TwoWay}" Content="{x:Bind ViewModel.ThemeDarkText}" />
                    <RadioButton x:Name="DefaultThemeRadioButton" GroupName="ThemeGroup" Tag="Default" IsChecked="{x:Bind ViewModel.DefaultThemeSelected, Mode=TwoWay}" Content="{x:Bind ViewModel.ThemeSystemSettingDefaultText}" />
                </StackPanel>


                <TextBlock
                    Style="{StaticResource SubtitleTextBlockStyle}"
                    Margin="0,40,0,0"
                    Text="{x:Bind ViewModel.GameLibrariesText}" />
                <StackPanel Margin="0,10,0,0">
                    <usercontrols:GameLibrarySelectorControl SavesWhenToggled="true" />
                </StackPanel>


                <TextBlock
                    Style="{StaticResource SubtitleTextBlockStyle}"
                    Margin="0,40,0,0"
                    Text="{x:Bind ViewModel.DllsDeveloperOptionsText}" />
                <StackPanel Margin="0,10,0,0">
                    <ComboBox Header="{x:Bind ViewModel.ShowOnScreenIndicatorText}" ItemsSource="{Binding DLSSOnScreenIndicatorOptions, Mode=OneTime}" SelectedItem="{Binding SelectedDlssOnScreenIndicator, Mode=TwoWay}" Margin="0,0,0,8" />
                    <CheckBox Content="{x:Bind ViewModel.EnableLoggingToFileText}" IsChecked="{x:Bind ViewModel.DlssEnableLogging, Mode=TwoWay}" Margin="0,0,0,4"/>
                    <CheckBox Content="{x:Bind ViewModel.VerboseLoggingText}" IsChecked="{x:Bind ViewModel.DlssVerboseLogging, Mode=TwoWay}" IsEnabled="{x:Bind ViewModel.DlssEnableLogging, Mode=TwoWay}" Margin="0,0,0,4"/>
                    <CheckBox Content="{x:Bind ViewModel.EnableLoggingToConsoleWindowText}" IsChecked="{x:Bind ViewModel.DlssLoggingToWindow, Mode=TwoWay}"  Margin="0,0,0,4"/>
                </StackPanel>


                <TextBlock
                    Style="{StaticResource SubtitleTextBlockStyle}"
                    Margin="0,40,0,0"
                    Text="{x:Bind ViewModel.AllowUntrustedText}" />
                <StackPanel Margin="0,10,0,0">
                    <ToggleSwitch IsOn="{x:Bind ViewModel.AllowUntrusted, Mode=TwoWay}" OffContent="No" OnContent="Yes" Margin="0,0,0,4"/>
                    <TextBlock Text="{x:Bind ViewModel.AllowUntrustedInfo}" Style="{ThemeResource CaptionTextBlockStyle}" FontStyle="Italic" Margin="0,8,0,0" />
                </StackPanel>


                <TextBlock
                    Style="{StaticResource SubtitleTextBlockStyle}"
                    Margin="0,40,0,0"
                    Text="{x:Bind ViewModel.AllowDebugDllsText}" />
                <StackPanel Margin="0,10,0,0">
                    <ToggleSwitch IsOn="{x:Bind ViewModel.AllowDebugDlls, Mode=TwoWay}" OffContent="No" OnContent="Yes" Margin="0,0,0,4"/>
                    <TextBlock Text="{x:Bind ViewModel.AllowDebugDllsInfo}" Style="{ThemeResource CaptionTextBlockStyle}" FontStyle="Italic" Margin="0,8,0,0" />
                </StackPanel>

                
                <TextBlock
                    Style="{StaticResource SubtitleTextBlockStyle}"
                    Margin="0,40,0,0"
                    Text="{x:Bind ViewModel.ShowOnlyDownloadedDllsText}" />
                <StackPanel Margin="0,10,0,0">
                    <ToggleSwitch IsOn="{x:Bind ViewModel.OnlyShowDownloadedDlls, Mode=TwoWay}" OffContent="No" OnContent="Yes" Margin="0,0,0,4" />
                    <TextBlock Text="{x:Bind ViewModel.ApliesOnlyToDllPickerNotLibraryText}" Style="{ThemeResource CaptionTextBlockStyle}" FontStyle="Italic" Margin="0,8,0,0" />
                </StackPanel>


                <TextBlock
                    Style="{StaticResource SubtitleTextBlockStyle}"
                    Margin="0,40,0,0"
                    Text="Logging" />
                <StackPanel Margin="0,10,0,0">
                    <ComboBox x:Name="LoggingComboBox" ItemsSource="{x:Bind ViewModel.LoggingLevels}" SelectedItem="{x:Bind ViewModel.LoggingLevel, Mode=TwoWay}" />
                    <TextBlock Style="{ThemeResource CaptionTextBlockStyle}" FontStyle="Italic" Margin="0,8,0,0">
                        <Run Text="{x:Bind ViewModel.YourCurrentLogfileText}" /><Hyperlink ct_winui:HyperlinkExtensions.Command="{x:Bind ViewModel.OpenLogFileCommand}"><Run Text="{x:Bind ViewModel.CurrentLogPath}" /></Hyperlink>.
                    </TextBlock>
                </StackPanel>


                <TextBlock
                    Style="{StaticResource SubtitleTextBlockStyle}"
                    Margin="0,40,0,0"
                    Text="About" />
                <TextBlock Margin="0,12,0,0">
                    <Run Text="{x:Bind ViewModel.VersionText}" />
                    <Run Text="{x:Bind ViewModel.AppVersion}" />
                </TextBlock>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,12,0,0" Spacing="16" >
                    <Button Content="{x:Bind ViewModel.CheckForUpdatesText}" Command="{x:Bind ViewModel.CheckForUpdatesCommand}" />
                    <ProgressRing Width="25" Height="25" IsIndeterminate="True" IsActive="{x:Bind ViewModel.IsCheckingForUpdates, Mode=OneWay}" />
                </StackPanel>
                                
                <RichTextBlock Margin="0,24,0,0">
                    <Paragraph Margin="0,12,0,0">
                        Github:
                        <Hyperlink NavigateUri="https://github.com/beeradmoore/dlss-swapper">beeradmoore/dlss-swapper</Hyperlink>
                    </Paragraph>
                    <Paragraph Margin="0,0,0,0">
                        Twitter:
                        <Hyperlink NavigateUri="https://twitter.com/dlss_swapper">@dlss_swapper</Hyperlink>
                    </Paragraph>
                    <Paragraph Margin="0,0,0,0">
                        Reddit:
                        <Hyperlink NavigateUri="https://www.reddit.com/r/DLSS_Swapper/">r/DLSS_Swapper</Hyperlink>
                    </Paragraph>
                    <Paragraph Margin="0,12,0,0">
                        <Hyperlink ct_winui:HyperlinkExtensions.Command="{x:Bind ViewModel.OpenAcknowledgementsCommand}">
                            <Run Text="{x:Bind ViewModel.AcknowledgementsText}" />
                        </Hyperlink>
                    </Paragraph>
                </RichTextBlock>

                <TextBlock
                    Style="{StaticResource SubtitleTextBlockStyle}"
                    Margin="0,40,0,0"
                    Text="{x:Bind ViewModel.GiveFeedbackText}" />
                <RichTextBlock Margin="0,12,0,0">
                    <Paragraph>
                        <Run Text="{x:Bind ViewModel.GiveFeedbackInfo}" />
                        <Hyperlink NavigateUri="https://github.com/beeradmoore/dlss-swapper/issues">GitHub repository</Hyperlink> .
                    </Paragraph>
                </RichTextBlock>
                
                <TextBlock
                    Style="{StaticResource SubtitleTextBlockStyle}"
                    Margin="0,40,0,0"
                    Text="{x:Bind ViewModel.TroubleshootingText}" />
                <StackPanel Margin="0,10,0,0" Orientation="Vertical">
                    <RichTextBlock>
                        <Paragraph Margin="0,12,0,0">
                            <Hyperlink NavigateUri="https://github.com/beeradmoore/dlss-swapper/wiki/Troubleshooting">
                                <Run Text="{x:Bind ViewModel.GeneralTroubleshootingGuideText}" />
                            </Hyperlink>
                        </Paragraph>
                        <Paragraph Margin="0,12,0,0">
                            <Hyperlink ct_winui:HyperlinkExtensions.Command="{x:Bind ViewModel.OpenNetworkTesterCommand}">
                                <Run Text="{x:Bind ViewModel.NetworkTesterText}" />
                            </Hyperlink>
                        </Paragraph>
                        <Paragraph Margin="0,12,0,0">
                            <Hyperlink ct_winui:HyperlinkExtensions.Command="{x:Bind ViewModel.OpenDiagnosticsCommand}">
                                <Run Text="{x:Bind ViewModel.DiagnosticsText}" />
                            </Hyperlink>
                        </Paragraph>
                    </RichTextBlock>
                </StackPanel>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>
